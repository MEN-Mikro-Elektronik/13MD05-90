<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>MEN - MDIS_API Library for Linux - mdis_api_specification.c File Reference</title>
<meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<meta name="Language" content="en, english">
<meta name="Copyright" content="All material copyright MEN Mikro Elektronik GmbH">
<link href="men_stylesheet.css" rel="stylesheet" type="text/css">
</head>
<body>

<div class="left_to_right" style="padding-top: 6px; background-color: #F0F0F0; height: 110px; border-bottom: 2px solid #D1D1D2;">
	<!-- Titel -->
	<img src="menlogo.gif" alt="MEN" style="float: left; height: 103px; width: 155px; margin: 0px;"></a>
	<h1 style="margin: 0px; padding-top: 35px; padding-bottom: 0px;">MDIS_API Library for Linux &nbsp; for MDIS4Linux fileset 1.8</h1>
	<h3>mdis_api_specification.c File Reference</h3>
</div>

<div class="left_to_right">
<!-- Hauptteil -->
	<div class="main">
<!-- Generated by Doxygen 1.3.2 -->
<div class="qindex"><a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="annotated.html">Data&nbsp;Structures</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="functions.html">Data&nbsp;Fields</a> | <a class="qindex" href="globals.html">Globals</a> | <a class="qindex" href="pages.html">Related&nbsp;Pages</a></div>
<h1>mdis_api_specification.c File Reference</h1>MDIS_API specification.  
<a href="#_details">More...</a>
<p>
<table border=0 cellpadding=0 cellspacing=0>
<tr><td></td></tr>
<tr><td colspan=2><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>MDIS_PATH __MAPILIB&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="mdis__api__specification_8c.html#a0">M_open</a> (const char *device)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Open path to device. </em> <a href="#a0"></a><em><br><br></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>int32 __MAPILIB&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="mdis__api__specification_8c.html#a1">M_close</a> (MDIS_PATH path)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Close path to device. </em> <a href="#a1"></a><em><br><br></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>int32 __MAPILIB&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="mdis__api__specification_8c.html#a2">M_read</a> (MDIS_PATH path, int32 *valueP)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Read 32-bit integer value from device. </em> <a href="#a2"></a><em><br><br></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>int32 __MAPILIB&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="mdis__api__specification_8c.html#a3">M_write</a> (MDIS_PATH path, int32 value)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Write 32-bit integer value to device. </em> <a href="#a3"></a><em><br><br></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>int32 __MAPILIB&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="mdis__api__specification_8c.html#a4">M_getblock</a> (MDIS_PATH path, u_int8 *buffer, int32 length)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Read data block from device. </em> <a href="#a4"></a><em><br><br></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>int32 __MAPILIB&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="mdis__api__specification_8c.html#a5">M_setblock</a> (MDIS_PATH path, const u_int8 *buffer, int32 length)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Write data block to device. </em> <a href="#a5"></a><em><br><br></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>int32 __MAPILIB&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="mdis__api__specification_8c.html#a6">M_getstat</a> (MDIS_PATH path, int32 code, int32 *dataP)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get status from device. </em> <a href="#a6"></a><em><br><br></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>int32 __MAPILIB&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="mdis__api__specification_8c.html#a7">M_setstat</a> (MDIS_PATH path, int32 code, INT32_OR_64 data)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Set status of device. </em> <a href="#a7"></a><em><br><br></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>char *__MAPILIB&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="mdis__api__specification_8c.html#a8">M_errstring</a> (int32 errCode)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Convert MDIS error code to static string. </em> <a href="#a8"></a><em><br><br></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>char *__MAPILIB&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="mdis__api__specification_8c.html#a9">M_errstringTs</a> (int32 errCode, char *strBuf)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Convert MDIS error code to string. </em> <a href="#a9"></a><em><br><br></td></tr>
</table>
<hr><a name="_details"></a><h2>Detailed Description</h2>
MDIS_API specification. 
<p>
<dl compact><dt><b>Author:</b></dt><dd><a href="mailto:klaus.popp@men.de">klaus.popp@men.de</a> <dl compact><dt><b>Date</b></dt><dd>2010/07/21 14:30:03 </dd></dl>
<dl compact><dt><b>Revision</b></dt><dd>1.7 </dd></dl>
</dd></dl>
<p>
This file contains the common, platform independent specification for the MDIS API.<hr><h2>Function Documentation</h2>
<a name="a1" doxytag="mdis_api_specification.c::M_close"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> int32 __MAPILIB M_close </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">MDIS_PATH&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>path</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Close path to device. 
<p>
<a class="el" href="mdis__api__specification_8c.html#a1">M_close()</a> closes the specified path to a device. Typically, if the last path to the device is closed, the device is deinitialized.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign=top><em>path</em>&nbsp;</td><td><b>IN</b> device file handle, returned by <a class="el" href="mdis__api__specification_8c.html#a0">M_open()</a> </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd><code>0</code> on success or <code>-1</code> on error. On failure, global <em>errno</em> is set to the error code </dd></dl>
    </td>
  </tr>
</table>
<a name="a8" doxytag="mdis_api_specification.c::M_errstring"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> char* __MAPILIB M_errstring </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int32&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>errCode</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Convert MDIS error code to static string. 
<p>
<dl compact><dt><b><a class="el" href="deprecated.html#_deprecated000001">Deprecated:</a></b></dt><dd>Use of this function in multithreaded applications or under OSes with global namespace is dangerous, since this function uses and returns a static buffer to print its error messages. Better use thread-safe version <a class="el" href="mdis__api__specification_8c.html#a9">M_errstringTs()</a>. </dd></dl>
<a class="el" href="mdis__api__specification_8c.html#a8">M_errstring()</a> creates an error message for error <em>errCode</em> and returns a pointer to the generated string with the following format:<p>
<div class="fragment"><pre>
 * ERROR &lt;errtype&gt; &lt;errcode&gt;: &lt;errdescr&gt; 
 * </pre></div><p>
where <em>errtype</em> describes if the error code comes from the system or the driver, <em>errcode</em> describes the error code in hexadecimal format or in the operating system’s native format. <em>errdescr</em> is the corresponding error message string.<p>
<b>Examples</b>: <div class="fragment"><pre>
   ERROR (MDIS) 0x1103: MK: illegal parameter
   ERROR (OS9) #000:221: module not found
   </pre></div><p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign=top><em>errCode</em>&nbsp;</td><td><b>IN</b> error code determined by <a class="elRef" doxygen="lin_usr_oss.tag:../../../../USR_OSS/DOC/html/" href="../../../../USR_OSS/DOC/html/errno_8c.html#a1">UOS_ErrnoGet()</a> </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>pointer to error message (static buffer!) </dd></dl>
    </td>
  </tr>
</table>
<a name="a9" doxytag="mdis_api_specification.c::M_errstringTs"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> char* __MAPILIB M_errstringTs </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int32&nbsp;</td>
          <td class="mdname" nowrap> <em>errCode</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>char *&nbsp;</td>
          <td class="mdname" nowrap> <em>strBuf</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Convert MDIS error code to string. 
<p>
<a class="el" href="mdis__api__specification_8c.html#a9">M_errstringTs()</a> creates an error message for error <em>errCode</em> and returns a pointer to the generated string with the following format:<p>
<div class="fragment"><pre>
 * ERROR &lt;errtype&gt; &lt;errcode&gt;: &lt;errdescr&gt; 
 * </pre></div><p>
where <em>errtype</em> describes if the error code comes from the system or the driver, <em>errcode</em> describes the error code in hexadecimal format or in the operating system’s native format. <em>errdescr</em> is the corresponding error message string.<p>
<b>Examples</b>: <div class="fragment"><pre>
    ERROR (MDIS) 0x1103: MK: illegal parameter
    ERROR (OS9) #000:221: module not found
   </pre></div><p>
<dl compact><dt><b>Remarks:</b></dt><dd>This function has been added in MDIS4/2003</dd></dl>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign=top><em>errCode</em>&nbsp;</td><td><b>IN</b> error code determined by <a class="elRef" doxygen="lin_usr_oss.tag:../../../../USR_OSS/DOC/html/" href="../../../../USR_OSS/DOC/html/errno_8c.html#a1">UOS_ErrnoGet()</a> </td></tr>
    <tr><td valign=top><em>strBuf</em>&nbsp;</td><td><b>OUT</b> filled with error message (should have space for 512 characters, including '\0') </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd><em>strBuf</em> </dd></dl>
    </td>
  </tr>
</table>
<a name="a4" doxytag="mdis_api_specification.c::M_getblock"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> int32 __MAPILIB M_getblock </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">MDIS_PATH&nbsp;</td>
          <td class="mdname" nowrap> <em>path</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>u_int8 *&nbsp;</td>
          <td class="mdname" nowrap> <em>buffer</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>int32&nbsp;</td>
          <td class="mdname" nowrap> <em>length</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Read data block from device. 
<p>
<a class="el" href="mdis__api__specification_8c.html#a4">M_getblock()</a> reads a data block of (maximum) <em>length</em> bytes from the specified path into buffer <em>buf</em> provided by the application and returns the number of bytes read. Depending on the device driver implementation, you can read data from the hardware or from an input buffer.<p>
If an input buffer is supported, the buffer handling method depends on the block I/O mode used. The minimum size of the application buffer, one buffer entry, can be queried using the <code>M_BUF_RD_WIDTH</code> GetStat call. If the requested block size is smaller than one buffer entry, the function returns an error.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign=top><em>path</em>&nbsp;</td><td><b>IN</b> device file handle, returned by <a class="el" href="mdis__api__specification_8c.html#a0">M_open()</a> </td></tr>
    <tr><td valign=top><em>buffer</em>&nbsp;</td><td><b>OUT</b> will contain read data </td></tr>
    <tr><td valign=top><em>length</em>&nbsp;</td><td><b>IN</b> max. number of bytes to read</td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>number of bytes read on success or <code>-1</code> on error. On failure, global <em>errno</em> is set to the error code</dd></dl>
<b>Example</b>: <div class="fragment"><pre><span class="preprocessor"> #include &lt;stdio.h&gt;</span>
<span class="preprocessor"> #include &lt;MEN/men_typs.h&gt;</span>
<span class="preprocessor"> #include &lt;MEN/mdis_api.h&gt;</span>
<span class="preprocessor"> #include &lt;MEN/usr_oss.h&gt;</span>

 <span class="keywordtype">int</span> main( <span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> **argv)
 {
  u_int8 readBuf[32];
  <span class="keywordtype">char</span> strBuf[128];
  int32 readSize;

  <span class="comment">// .. open path to device ..</span>

  <span class="comment">//------------------------</span>
  <span class="comment">// read block from device (32 bytes)</span>
  <span class="keywordflow">if</span> ((readSize = <a class="code" href="mdis__api__specification_8c.html#a4">M_getblock</a>(path, readBuf, 32)) &lt; 0) {
      <span class="comment">// failed: create error message </span>
      printf(<span class="stringliteral">"*** getblock: %s\n"</span>, <a class="code" href="mdis__api__specification_8c.html#a9">M_errstringTs</a>(<a class="codeRef" doxygen="lin_usr_oss.tag:../../../../USR_OSS/DOC/html/" href="../../../../USR_OSS/DOC/html/errno_8c.html#a1">UOS_ErrnoGet</a>(),strBuf));
  }
  <span class="keywordflow">else</span>
      printf(<span class="stringliteral">"%d bytes read\n"</span>, readSize);
 }
</pre></div>    </td>
  </tr>
</table>
<a name="a6" doxytag="mdis_api_specification.c::M_getstat"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> int32 __MAPILIB M_getstat </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">MDIS_PATH&nbsp;</td>
          <td class="mdname" nowrap> <em>path</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>int32&nbsp;</td>
          <td class="mdname" nowrap> <em>code</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>int32 *&nbsp;</td>
          <td class="mdname" nowrap> <em>dataP</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Get status from device. 
<p>
<a class="el" href="mdis__api__specification_8c.html#a6">M_getstat()</a> is used to obtain the parameters for path. The parameter <em>code</em> specifies which parameter is to be obtained. The value obtained is written to the variable <em>data</em> depending on the status code type:<p>
<ul>
<li>For normal status codes, <em>dataP</em> points to a 32-bit integer value.</li><li>For block status codes, <em>dataP</em> it is interpreted as a pointer to structure <a class="el" href="structM__SG__BLOCK.html">M_SG_BLOCK</a>, which contains the size and location of the data buffer. Note that block getstats can be used to exchange data with the driver in both directions (to and from the driver).</li></ul>
<p>
All standard status codes are defined in <em>MEN/mdis_api</em>.h and in the MDIS5 user guide. In addition, most device drivers also support device-specific status codes. These are defined in the driver’s header file and described in the corresponding device driver user manual.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign=top><em>path</em>&nbsp;</td><td><b>IN</b> device file handle, returned by <a class="el" href="mdis__api__specification_8c.html#a0">M_open()</a> </td></tr>
    <tr><td valign=top><em>code</em>&nbsp;</td><td><b>IN</b> status code (defined in <em><a class="el" href="mdis__api_8h.html">mdis_api.h</a></em> or <em>xxx_drv.h</em> </td></tr>
    <tr><td valign=top><em>dataP</em>&nbsp;</td><td><b>IN/OUT</b> depends on type of code:<ul>
<li>standard codes: *dataP will contain the obtained paramter</li><li>block codes: dataP must point to <a class="el" href="structM__SG__BLOCK.html">M_SG_BLOCK</a> structure</li></ul>
</td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd><code>0</code> on success or <code>-1</code> on error. On failure, global <em>errno</em> is set to the error code</dd></dl>
<b>Example</b>: <div class="fragment"><pre>  <span class="keywordtype">char</span> llHandler[M_MAX_NAME];
  int32 chNumber;
  <a class="code" href="structM__SG__BLOCK.html">M_SG_BLOCK</a> blk;

  <span class="comment">// standard getstat: (here: number of channels)</span>
  <span class="keywordflow">if</span>( <a class="code" href="mdis__api__specification_8c.html#a6">M_getstat</a>(path, M_LL_CH_NUMBER, &amp;chNumber) &lt; 0 ) 
      printf(<span class="stringliteral">"*** getstat: %s\n"</span>, <a class="code" href="mdis__api__specification_8c.html#a9">M_errstringTs</a>(<a class="codeRef" doxygen="lin_usr_oss.tag:../../../../USR_OSS/DOC/html/" href="../../../../USR_OSS/DOC/html/errno_8c.html#a1">UOS_ErrnoGet</a>(),strBuf));    
  <span class="keywordflow">else</span>
      printf(<span class="stringliteral">"%d channels\n"</span>, chNumber);

  <span class="comment">// block getstat (here: device driver name)</span>
  blk.<a class="code" href="structM__SG__BLOCK.html#o0">size</a> = <span class="keyword">sizeof</span>(llHandler);
  blk.<a class="code" href="structM__SG__BLOCK.html#o1">data</a> = (<span class="keywordtype">void</span>*)llHandler;

  <span class="keywordflow">if</span>( <a class="code" href="mdis__api__specification_8c.html#a6">M_getstat</a>(path, M_MK_BLK_LL_HANDLER, (int32*)&amp;blk) &lt; 0)
      printf(<span class="stringliteral">"*** getstat: %s\n"</span>,<a class="code" href="mdis__api__specification_8c.html#a9">M_errstringTs</a>(<a class="codeRef" doxygen="lin_usr_oss.tag:../../../../USR_OSS/DOC/html/" href="../../../../USR_OSS/DOC/html/errno_8c.html#a1">UOS_ErrnoGet</a>(),strBuf));
  <span class="keywordflow">else</span>
      printf(<span class="stringliteral">"device driver: %s\n"</span>, llHandler);
 }
</pre></div>    </td>
  </tr>
</table>
<a name="a0" doxytag="mdis_api_specification.c::M_open"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> MDIS_PATH __MAPILIB M_open </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">const char *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>device</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Open path to device. 
<p>
<a class="el" href="mdis__api__specification_8c.html#a0">M_open()</a> opens a new path to a device. The device name is passed as a string. The function returns the path number (handle) by which the device is to be referred to from then on.<p>
The device name may be OS-specific, but is typically something like <code>"/m22_1"</code>.<p>
Typically, if the first path is opened to the device, the device is initialized. Subsequent references to the device are by the returned path number path. If the same device is opened several times, there are different paths to it.<p>
Each of these paths have the same (global) device parameters but have their own (local) path parameters:<ul>
<li>current channel number</li><li>channel I/O mode</li></ul>
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign=top><em>device</em>&nbsp;</td><td><b>IN</b> name of the device e.g. "/m22_1"</td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>the device handle (&gt;= 0) on success or <code>-1</code> on error. On failure, global <em>errno</em> is set to the error code</dd></dl>
<b>Example</b>: <div class="fragment"><pre><span class="preprocessor">   #include &lt;MEN/men_typs.h&gt;</span>
<span class="preprocessor">   #include &lt;MEN/mdis_api.h&gt;</span>
   ...

   MDIS_PATH path;

   path = <a class="code" href="mdis__api__specification_8c.html#a0">M_open</a>( <span class="stringliteral">"/m22_1"</span> );
   <span class="keywordflow">if</span>( path &lt; 0 ){
       <span class="comment">// open failed</span>
       <span class="keywordflow">return</span> -1;
   }
</pre></div>    </td>
  </tr>
</table>
<a name="a2" doxytag="mdis_api_specification.c::M_read"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> int32 __MAPILIB M_read </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">MDIS_PATH&nbsp;</td>
          <td class="mdname" nowrap> <em>path</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>int32 *&nbsp;</td>
          <td class="mdname" nowrap> <em>valueP</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Read 32-bit integer value from device. 
<p>
<a class="el" href="mdis__api__specification_8c.html#a2">M_read()</a> reads a 32-bit integer value from the current channel of the specified path into the variable where value points to, which is passed as a pointer. Depending on the selected I/O mode, the current channel may be incremented.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign=top><em>path</em>&nbsp;</td><td><b>IN</b> device file handle, returned by <a class="el" href="mdis__api__specification_8c.html#a0">M_open()</a> </td></tr>
    <tr><td valign=top><em>valueP</em>&nbsp;</td><td><b>OUT</b> pointer to variable where read value will be stored.</td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd><code>0</code> on success or <code>-1</code> on error. On failure, global <em>errno</em> is set to the error code</dd></dl>
<b>Example</b>: <div class="fragment"><pre><span class="preprocessor"> #include &lt;stdio.h&gt;</span>
<span class="preprocessor"> #include &lt;MEN/men_typs.h&gt;</span>
<span class="preprocessor"> #include &lt;MEN/mdis_api.h&gt;</span>
<span class="preprocessor"> #include &lt;MEN/usr_oss.h&gt;</span>

 <span class="keywordtype">int</span> main( <span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> **argv)
 {
  int32 readData;
  <span class="keywordtype">char</span> strBuf[128];
  <span class="comment">// .. open path to device ..</span>

  <span class="comment">//------------------------</span>
  <span class="comment">// read from device</span>

  <span class="keywordflow">if</span> (<a class="code" href="mdis__api__specification_8c.html#a2">M_read</a>(path, &amp;readData) &lt; 0) {
      <span class="comment">// failed: create error message</span>
      printf(<span class="stringliteral">"*** can’t read: %s\n"</span>, <a class="code" href="mdis__api__specification_8c.html#a9">M_errstringTs</a>(<a class="codeRef" doxygen="lin_usr_oss.tag:../../../../USR_OSS/DOC/html/" href="../../../../USR_OSS/DOC/html/errno_8c.html#a1">UOS_ErrnoGet</a>(),strBuf));
  }
  <span class="keywordflow">else</span>
      printf(<span class="stringliteral">"value=0x%lx read\n"</span>, readData);

  <span class="comment">// ...</span>
 }
</pre></div>    </td>
  </tr>
</table>
<a name="a5" doxytag="mdis_api_specification.c::M_setblock"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> int32 __MAPILIB M_setblock </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">MDIS_PATH&nbsp;</td>
          <td class="mdname" nowrap> <em>path</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>const u_int8 *&nbsp;</td>
          <td class="mdname" nowrap> <em>buffer</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>int32&nbsp;</td>
          <td class="mdname" nowrap> <em>length</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Write data block to device. 
<p>
<a class="el" href="mdis__api__specification_8c.html#a5">M_setblock()</a> writes a data block buf of (maximum) <em>length</em> bytes to the specified path and returns the number of bytes written. Depending on the device driver implementation, you can write data to the hardware or to an output buffer.<p>
If an output buffer is supported, the buffer handling method depends on the block I/O mode used. The minimum size of the application buffer, one buffer entry, can be queried using the <code>M_BUF_WR_WIDTH</code> GetStat call. If the requested block size is smaller than one buffer entry, the function returns an error.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign=top><em>path</em>&nbsp;</td><td><b>IN</b> device file handle, returned by <a class="el" href="mdis__api__specification_8c.html#a0">M_open()</a> </td></tr>
    <tr><td valign=top><em>buffer</em>&nbsp;</td><td><b>IN</b> data block to write </td></tr>
    <tr><td valign=top><em>length</em>&nbsp;</td><td><b>IN</b> max. number of bytes to write</td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>number of bytes written on success or <code>-1</code> on error. On failure, global <em>errno</em> is set to the error code</dd></dl>
<b>Example</b>: <div class="fragment"><pre><span class="preprocessor"> #include &lt;stdio.h&gt;</span>
<span class="preprocessor"> #include &lt;MEN/men_typs.h&gt;</span>
<span class="preprocessor"> #include &lt;MEN/mdis_api.h&gt;</span>
<span class="preprocessor"> #include &lt;MEN/usr_oss.h&gt;</span>

 <span class="keywordtype">int</span> main( <span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> **argv)
 {
  u_int8 writeBuf[32];
  <span class="keywordtype">char</span> strBuf[128];
  int32 writeSize;

  <span class="comment">// .. open path to device ..</span>

  <span class="comment">//------------------------</span>
  <span class="comment">// write block to device (32 bytes)</span>
  <span class="keywordflow">if</span> ((writeSize = <a class="code" href="mdis__api__specification_8c.html#a4">M_getblock</a>(path, writeBuf, 32)) &lt; 0) {
      <span class="comment">// failed: create error message </span>
      printf(<span class="stringliteral">"*** setblock: %s\n"</span>, <a class="code" href="mdis__api__specification_8c.html#a9">M_errstringTs</a>(<a class="codeRef" doxygen="lin_usr_oss.tag:../../../../USR_OSS/DOC/html/" href="../../../../USR_OSS/DOC/html/errno_8c.html#a1">UOS_ErrnoGet</a>(),strBuf));
  }
  <span class="keywordflow">else</span>
      printf(<span class="stringliteral">"%d bytes written\n"</span>, writeSize);
 }
</pre></div>    </td>
  </tr>
</table>
<a name="a7" doxytag="mdis_api_specification.c::M_setstat"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> int32 __MAPILIB M_setstat </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">MDIS_PATH&nbsp;</td>
          <td class="mdname" nowrap> <em>path</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>int32&nbsp;</td>
          <td class="mdname" nowrap> <em>code</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>INT32_OR_64&nbsp;</td>
          <td class="mdname" nowrap> <em>data</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Set status of device. 
<p>
<a class="el" href="mdis__api__specification_8c.html#a7">M_setstat()</a> is used to modify the parameters for path. The status code <em>code</em> specifies which parameter is to be set to the new value data.<ul>
<li>For normal status codes, <em>data</em> contains a 32-bit integer value.</li><li>For block status codes, <em>data</em> it is interpreted as a pointer to structure <a class="el" href="structM__SG__BLOCK.html">M_SG_BLOCK</a>, which contains the size and location of the data buffer. Note that block setstats can be used only to send data from the application to the driver (not the opposite direction).</li></ul>
<p>
All standard status codes are defined in <em>MEN/mdis_api</em>.h and in the MDIS5 user guide. In addition, most device drivers also support device-specific status codes. These are defined in the driver’s header file and described in the corresponding device driver user manual.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign=top><em>path</em>&nbsp;</td><td><b>IN</b> device file handle, returned by <a class="el" href="mdis__api__specification_8c.html#a0">M_open()</a> </td></tr>
    <tr><td valign=top><em>code</em>&nbsp;</td><td><b>IN</b> status code (defined in <em><a class="el" href="mdis__api_8h.html">mdis_api.h</a></em> or <em>xxx_drv.h</em> </td></tr>
    <tr><td valign=top><em>data</em>&nbsp;</td><td><b>IN</b> depends on type of code:<ul>
<li>standard codes: value to write</li><li>block codes: data must point to <a class="el" href="structM__SG__BLOCK.html">M_SG_BLOCK</a> structure</li></ul>
</td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd><code>0</code> on success or <code>-1</code> on error. On failure, global <em>errno</em> is set to the error code</dd></dl>
<b>Example</b>: <div class="fragment"><pre>  int32 chCurrent;
  u_int8 blkData[32];
  <a class="code" href="structM__SG__BLOCK.html">M_SG_BLOCK</a> blk;

  <span class="comment">// standard setstat: (here: current channel)</span>
  <span class="keywordflow">if</span>( <a class="code" href="mdis__api__specification_8c.html#a7">M_setstat</a>(path, M_MK_CH_CURRENT, chCurrent) &lt; 0 ) 
      printf(<span class="stringliteral">"*** setstat: %s\n"</span>, <a class="code" href="mdis__api__specification_8c.html#a9">M_errstringTs</a>(<a class="codeRef" doxygen="lin_usr_oss.tag:../../../../USR_OSS/DOC/html/" href="../../../../USR_OSS/DOC/html/errno_8c.html#a1">UOS_ErrnoGet</a>(),strBuf));    

  <span class="comment">// block setstat (here: device device specific)</span>
  blk.<a class="code" href="structM__SG__BLOCK.html#o0">size</a> = <span class="keyword">sizeof</span>(blkData);
  blk.<a class="code" href="structM__SG__BLOCK.html#o1">data</a> = (<span class="keywordtype">void</span>*)blkData;

  <span class="keywordflow">if</span>( <a class="code" href="mdis__api__specification_8c.html#a7">M_setstat</a>(path, M12_BLK_PARAMS, (int32*)&amp;blk) &lt; 0)
      printf(<span class="stringliteral">"*** setstat: %s\n"</span>,<a class="code" href="mdis__api__specification_8c.html#a9">M_errstringTs</a>(<a class="codeRef" doxygen="lin_usr_oss.tag:../../../../USR_OSS/DOC/html/" href="../../../../USR_OSS/DOC/html/errno_8c.html#a1">UOS_ErrnoGet</a>(),strBuf));
</pre></div>    </td>
  </tr>
</table>
<a name="a3" doxytag="mdis_api_specification.c::M_write"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> int32 __MAPILIB M_write </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">MDIS_PATH&nbsp;</td>
          <td class="mdname" nowrap> <em>path</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>int32&nbsp;</td>
          <td class="mdname" nowrap> <em>value</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Write 32-bit integer value to device. 
<p>
<a class="el" href="mdis__api__specification_8c.html#a3">M_write()</a> outputs a 32-bit integer value to the current channel of the specified path. Depending on the selected I/O mode, the current channel may be incremented.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign=top><em>path</em>&nbsp;</td><td><b>IN</b> device file handle, returned by <a class="el" href="mdis__api__specification_8c.html#a0">M_open()</a> </td></tr>
    <tr><td valign=top><em>value</em>&nbsp;</td><td><b>IN</b> value to write</td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd><code>0</code> on success or <code>-1</code> on error. On failure, global <em>errno</em> is set to the error code</dd></dl>
<b>Example</b>: <div class="fragment"><pre><span class="preprocessor"> #include &lt;stdio.h&gt;</span>
<span class="preprocessor"> #include &lt;MEN/men_typs.h&gt;</span>
<span class="preprocessor"> #include &lt;MEN/mdis_api.h&gt;</span>
<span class="preprocessor"> #include &lt;MEN/usr_oss.h&gt;</span>

 <span class="keywordtype">int</span> main( <span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> **argv)
 {
  int32 writeData = 0x12345678;
  <span class="keywordtype">char</span> strBuf[128];

  <span class="comment">// .. open path to device ..</span>

  <span class="comment">//------------------------</span>
  <span class="comment">// write to device</span>

  <span class="keywordflow">if</span> (<a class="code" href="mdis__api__specification_8c.html#a3">M_write</a>(path, writeData) &lt; 0) {
      <span class="comment">// failed: create error message </span>
      printf(<span class="stringliteral">"*** can’t write: %s\n"</span>, <a class="code" href="mdis__api__specification_8c.html#a9">M_errstringTs</a>(<a class="codeRef" doxygen="lin_usr_oss.tag:../../../../USR_OSS/DOC/html/" href="../../../../USR_OSS/DOC/html/errno_8c.html#a1">UOS_ErrnoGet</a>(),strBuf));
  }
 }
</pre></div>    </td>
  </tr>
</table>

	</div>
</div>

<div class="footer">
<!-- Footer -->
	<p class="footer">
	Generated for MDIS_API Library for Linux using <a href="http://www.doxygen.org">doxygen</a>.<br>
	Copyright &copy; 2012 <a href="http://www.men.de">MEN Mikro Elektronik GmbH</a>. All Rights Reserved.
	</p>
</div>

</body>
</html>

